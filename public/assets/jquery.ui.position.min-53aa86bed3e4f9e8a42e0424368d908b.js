!function(t){t.ui=t.ui||{};var o=/left|center|right/,i=/top|center|bottom/,e="center",n=t.fn.position,l=t.fn.offset;t.fn.position=function(l){if(!l||!l.of)return n.apply(this,arguments);l=t.extend({},l);var f,s,r,a=t(l.of),h=a[0],p=(l.collision||"flip").split(" "),c=l.offset?l.offset.split(" "):[0,0];return 9===h.nodeType?(f=a.width(),s=a.height(),r={top:0,left:0}):h.setTimeout?(f=a.width(),s=a.height(),r={top:a.scrollTop(),left:a.scrollLeft()}):h.preventDefault?(l.at="left top",f=s=0,r={top:l.of.pageY,left:l.of.pageX}):(f=a.outerWidth(),s=a.outerHeight(),r=a.offset()),t.each(["my","at"],function(){var t=(l[this]||"").split(" ");1===t.length&&(t=o.test(t[0])?t.concat([e]):i.test(t[0])?[e].concat(t):[e,e]),t[0]=o.test(t[0])?t[0]:e,t[1]=i.test(t[1])?t[1]:e,l[this]=t}),1===p.length&&(p[1]=p[0]),c[0]=parseInt(c[0],10)||0,1===c.length&&(c[1]=c[0]),c[1]=parseInt(c[1],10)||0,"right"===l.at[0]?r.left+=f:l.at[0]===e&&(r.left+=f/2),"bottom"===l.at[1]?r.top+=s:l.at[1]===e&&(r.top+=s/2),r.left+=c[0],r.top+=c[1],this.each(function(){var o,i=t(this),n=i.outerWidth(),a=i.outerHeight(),h=parseInt(t.curCSS(this,"marginLeft",!0))||0,u=parseInt(t.curCSS(this,"marginTop",!0))||0,g=n+h+(parseInt(t.curCSS(this,"marginRight",!0))||0),m=a+u+(parseInt(t.curCSS(this,"marginBottom",!0))||0),d=t.extend({},r);"right"===l.my[0]?d.left-=n:l.my[0]===e&&(d.left-=n/2),"bottom"===l.my[1]?d.top-=a:l.my[1]===e&&(d.top-=a/2),d.left=Math.round(d.left),d.top=Math.round(d.top),o={left:d.left-h,top:d.top-u},t.each(["left","top"],function(i,e){t.ui.position[p[i]]&&t.ui.position[p[i]][e](d,{targetWidth:f,targetHeight:s,elemWidth:n,elemHeight:a,collisionPosition:o,collisionWidth:g,collisionHeight:m,offset:c,my:l.my,at:l.at})}),t.fn.bgiframe&&i.bgiframe(),i.offset(t.extend(d,{using:l.using}))})},t.ui.position={fit:{left:function(o,i){var e=t(window),n=i.collisionPosition.left+i.collisionWidth-e.width()-e.scrollLeft();o.left=n>0?o.left-n:Math.max(o.left-i.collisionPosition.left,o.left)},top:function(o,i){var e=t(window),n=i.collisionPosition.top+i.collisionHeight-e.height()-e.scrollTop();o.top=n>0?o.top-n:Math.max(o.top-i.collisionPosition.top,o.top)}},flip:{left:function(o,i){if(i.at[0]!==e){var n=t(window),l=i.collisionPosition.left+i.collisionWidth-n.width()-n.scrollLeft(),f="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,s="left"===i.at[0]?i.targetWidth:-i.targetWidth,r=-2*i.offset[0];o.left+=i.collisionPosition.left<0?f+s+r:l>0?f+s+r:0}},top:function(o,i){if(i.at[1]!==e){var n=t(window),l=i.collisionPosition.top+i.collisionHeight-n.height()-n.scrollTop(),f="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,s="top"===i.at[1]?i.targetHeight:-i.targetHeight,r=-2*i.offset[1];o.top+=i.collisionPosition.top<0?f+s+r:l>0?f+s+r:0}}}},t.offset.setOffset||(t.offset.setOffset=function(o,i){/static/.test(t.curCSS(o,"position"))&&(o.style.position="relative");var e=t(o),n=e.offset(),l=parseInt(t.curCSS(o,"top",!0),10)||0,f=parseInt(t.curCSS(o,"left",!0),10)||0,s={top:i.top-n.top+l,left:i.left-n.left+f};"using"in i?i.using.call(o,s):e.css(s)},t.fn.offset=function(o){var i=this[0];return i&&i.ownerDocument?o?this.each(function(){t.offset.setOffset(this,o)}):l.call(this):null})}(jQuery);